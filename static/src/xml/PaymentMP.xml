<?xml version="1.0" encoding="UTF-8"?>
<templates>

    <t t-name="pos_mercadopago_qr.PaymentMethodLineMP">
        <div class="mp-box" style="margin-bottom: 20px; padding: 15px; background: white; border: 1px solid #ccc; border-radius: 5px; text-align: center;">
            
            <t t-if="mpState.status == 'idle'">
                <div class="button highlight" style="padding: 20px; font-size: 20px; background-color: #0099ff; color: white; cursor: pointer;" t-on-click="startMercadoPago">
                    <i class="fa fa-qrcode"/> Generate QR Code
                </div>
            </t>

            <t t-if="mpState.status == 'loading'">
                <div style="font-size: 18px;">
                    <i class="fa fa-spinner fa-spin"/> Connecting...
                </div>
            </t>

            <t t-if="mpState.status == 'pending'">
                <div>
                    <div style="font-weight: bold; margin-bottom: 10px;">Scan to Pay</div>
                    <img t-att-src="mpState.qr_url" style="width: 100%; max-width: 250px; border: 1px solid #eee;"/>
                    <div style="margin-top: 10px; color: #666;">
                        <i class="fa fa-circle-o-notch fa-spin"/> Waiting for confirmation...
                    </div>
                </div>
            </t>

            <t t-if="mpState.status == 'approved'">
                <div style="color: green; font-size: 20px; font-weight: bold;">
                    <i class="fa fa-check-circle"/> Payment Approved
                </div>
            </t>

            <t t-if="mpState.status == 'error'">
                <div style="color: red;">
                    <p><t t-esc="mpState.error"/></p>
                    <div class="button" style="background: #eee; padding: 10px; cursor: pointer;" t-on-click="() => this.mpState.status = 'idle'">Retry</div>
                </div>
            </t>
        </div>
    </t>

    <t t-name="pos_mercadopago_qr.PaymentScreen" t-inherit="point_of_sale.PaymentScreen" t-inherit-mode="extension">
        
        <xpath expr="//div[hasclass('next')]" position="before">
            <t t-if="isMercadoPago">
                <t t-call="pos_mercadopago_qr.PaymentMethodLineMP"/>
            </t>
        </xpath>
        
    </t>

</templates>